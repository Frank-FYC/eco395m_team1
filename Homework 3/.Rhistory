coef(lm_medium_all)["green_rating"]
coef(lm_forward_all)["green_rating"]
coef(lm_backward_all)["green_rating"]
coef(lm_step_all)["green_rating"]
coefficients <- c(n.coefficients(lm_medium_all),
n.coefficients(lm_forward_all),
n.coefficients(lm_backward_all),
n.coefficients(lm_step_all)
)
models <- c("lm_medium_all Model",
"lm_forward_all Model",
"lm_backward_all Model",
"lm_step_all Model"
)
models.coefficients <- data.frame(
first = models,
second = coefficients
)
models.coefficients
models.coefficients <- data.frame(
model_type = models,
second = coefficients
)
models.coefficients
models.coefficients <- data.frame(
model_type = models,
Numver_of_coefficients= coefficients
)
coefficients <- c(n.coefficients(lm_medium_all),
n.coefficients(lm_forward_all),
n.coefficients(lm_backward_all),
n.coefficients(lm_step_all)
)
models <- c("lm_medium_all Model",
"lm_forward_all Model",
"lm_backward_all Model",
"lm_step_all Model"
)
models.coefficients <- data.frame(
model_type = models,
Numver_of_coefficients= coefficients
)
models.coefficients
variables <- c(n.coefficients(lm_medium_all),
n.coefficients(lm_forward_all),
n.coefficients(lm_backward_all),
n.coefficients(lm_step_all)
)
models <- c("lm_medium_all Model",
"lm_forward_all Model",
"lm_backward_all Model",
"lm_step_all Model"
)
models.coefficients <- data.frame(
model_type = models,
Number_of_variables= variables
)
models.variables
variables <- c(n.coefficients(lm_medium_all),
n.coefficients(lm_forward_all),
n.coefficients(lm_backward_all),
n.coefficients(lm_step_all)
)
models <- c("lm_medium_all Model",
"lm_forward_all Model",
"lm_backward_all Model",
"lm_step_all Model"
)
models.coefficients <- data.frame(
model_type = models,
Number_of_variables = variables
)
models.variables
variables <- c(n.coefficients(lm_medium_all),
n.coefficients(lm_forward_all),
n.coefficients(lm_backward_all),
n.coefficients(lm_step_all)
)
models <- c("lm_medium_all Model",
"lm_forward_all Model",
"lm_backward_all Model",
"lm_step_all Model"
)
models.variables <- data.frame(
model_type = models,
Number_of_variables = variables
)
models.variables
green_rating_coefficient <- c(
coef(lm_medium_all)["green_rating"],
coef(lm_forward_all)["green_rating"],
coef(lm_backward_all)["green_rating"],
coef(lm_step_all)["green_rating"]
)
models <- c("lm_medium_all Model",
"lm_forward_all Model",
"lm_backward_all Model",
"lm_step_all Model"
)
models.coefficients <- data.frame(
model_type = models,
green_rating_value = green_rating_coefficient
)
green_rating_coefficient
coef(lm_backward_all)["green_rating"]
green_rating_coefficient <- c(
coef(lm_medium_all)["green_rating"],
coef(lm_forward_all)["green_rating"],
"NULL",
coef(lm_step_all)["green_rating"]
)
models <- c("lm_medium_all Model",
"lm_forward_all Model",
"lm_backward_all Model",
"lm_step_all Model"
)
models.coefficients <- data.frame(
model_type = models,
green_rating_value = green_rating_coefficient
)
models.coefficients
getCall(lm_backward_all)
lm_backward_all
coef(lm_backward_all)["green_rating:amenities"]
lm_backward_all["green_rating:amenities"]
lm_backward_all$"green_rating:amenities"
lm_medium_a <- lm_medium(greenbuildings_a)
lm_forward_a <- lm_forward(greenbuildings_a)
lm_backward_a <- drop1(lm_backward(greenbuildings_a))
lm_step_a <- lm_step(greenbuildings_a)
lm_medium_b <- lm_medium(greenbuildings_b)
lm_forward_b <- lm_forward(greenbuildings_b)
lm_backward_b <- drop1(lm_backward(greenbuildings_b))
lm_step_b <- lm_step(greenbuildings_b)
coef(lm_medium_a)["green_rating"]
coef(lm_forward_a)["green_rating"]
coef(lm_backward_a)["green_rating"]
coef(lm_step_a)["green_rating"]
coef(lm_medium_b)["green_rating"]
coef(lm_forward_b)["green_rating"]
coef(lm_backward_b)["green_rating"]
coef(lm_step_b)["green_rating"]
green_rating_coefficient <- c(
coef(lm_medium_all)["green_rating"],
coef(lm_forward_all)["green_rating"],
"NULL",
coef(lm_step_all)["green_rating"],
coef(lm_medium_a)["green_rating"],
coef(lm_forward_a)["green_rating"],
"NULL",
coef(lm_step_a)["green_rating"],
coef(lm_medium_b)["green_rating"],
coef(lm_forward_b)["green_rating"],
"NULL",
coef(lm_step_b)["green_rating"]
)
models <- c("lm_medium_all Model",
"lm_forward_all Model",
"lm_backward_all Model",
"lm_step_class.a Model",
"lm_medium_class.a Model",
"lm_forward_class.a Model",
"lm_backward_class.a Model",
"lm_step_class.b Model",
"lm_medium_class.b Model",
"lm_forward_class.b Model",
"lm_backward_class.b Model",
"lm_step_class.b Model"
)
models.coefficients <- data.frame(
model_type = models,
green_rating_value = green_rating_coefficient
)
models.coefficients
models <- c("lm_medium_all Model",
"lm_forward_all Model",
"lm_backward_all Model",
"lm_step_all Model",
"lm_medium_class.a Model",
"lm_forward_class.a Model",
"lm_backward_class.a Model",
"lm_step_class.a Model",
"lm_medium_class.b Model",
"lm_forward_class.b Model",
"lm_backward_class.b Model",
"lm_step_class.b Model"
)
models.coefficients <- data.frame(
model_type = models,
green_rating_value = green_rating_coefficient
)
models.coefficients
green_rating_coefficient <- c(
coef(lm_medium_all)["green_rating"],
coef(lm_forward_all)["green_rating"],
"NULL",
coef(lm_step_all)["green_rating"],
coef(lm_medium_a)["green_rating"],
coef(lm_forward_a)["green_rating"],
"NULL",
coef(lm_step_a)["green_rating"],
coef(lm_medium_b)["green_rating"],
coef(lm_forward_b)["green_rating"],
"NULL",
coef(lm_step_b)["green_rating"]
)
green_rating_coefficient
green_rating_coefficient <- c(
coef(lm_medium_all)["green_rating"],
coef(lm_forward_all)["green_rating"],
coef(lm_backward_all)["green_rating"],
coef(lm_step_all)["green_rating"]
)
models <- c("lm_medium_all Model",
"lm_forward_all Model",
"lm_backward_all Model",
"lm_step_all Model"
)
models.coefficients <- data.frame(
model_type = models,
green_rating_value = green_rating_coefficient
)
green_rating_coefficient <- c(
coef(lm_medium_all)["green_rating"],
coef(lm_forward_all)["green_rating"],
paste(coef(lm_backward_all)["green_rating"]),
coef(lm_step_all)["green_rating"]
)
models <- c("lm_medium_all Model",
"lm_forward_all Model",
"lm_backward_all Model",
"lm_step_all Model"
)
models.coefficients <- data.frame(
model_type = models,
green_rating_value = green_rating_coefficient
)
green_rating_coefficient <- c(
coef(lm_medium_all)["green_rating"],
coef(lm_forward_all)["green_rating"],
"NA",
coef(lm_step_all)["green_rating"]
)
models <- c("lm_medium_all Model",
"lm_forward_all Model",
"lm_backward_all Model",
"lm_step_all Model"
)
models.coefficients <- data.frame(
model_type = models,
green_rating_value = green_rating_coefficient
)
models.coefficients
lm_medium_a <- lm_medium(greenbuildings_a)
lm_forward_a <- lm_forward(greenbuildings_a)
lm_backward_a <- drop1(lm_backward(greenbuildings_a))
lm_step_a <- lm_step(greenbuildings_a)
lm_medium_b <- lm_medium(greenbuildings_b)
lm_forward_b <- lm_forward(greenbuildings_b)
lm_backward_b <- drop1(lm_backward(greenbuildings_b))
lm_step_b <- lm_step(greenbuildings_b)
green_rating_coefficient <- c(
coef(lm_medium_all)["green_rating"],
coef(lm_forward_all)["green_rating"],
coef(lm_backward_all)["green_rating"],
coef(lm_step_all)["green_rating"],
coef(lm_medium_a)["green_rating"],
coef(lm_forward_a)["green_rating"],
coef(lm_backward_a)["green_rating"],
coef(lm_step_a)["green_rating"],
coef(lm_medium_b)["green_rating"],
coef(lm_forward_b)["green_rating"],
coef(lm_step_b)["green_rating"],
coef(lm_step_b)["green_rating"]
)
models <- c("lm_medium_all Model",
"lm_forward_all Model",
"lm_backward_all Model",
"lm_step_all Model",
"lm_medium_class.a Model",
"lm_forward_class.a Model",
"lm_backward_class.a Model",
"lm_step_class.a Model",
"lm_medium_class.b Model",
"lm_forward_class.b Model",
"lm_backward_class.b Model",
"lm_step_class.b Model"
)
models.coefficients <- data.frame(
model_type = models,
green_rating_value = green_rating_coefficient
)
green_rating_coefficient <- c(
coef(lm_medium_all)["green_rating"],
coef(lm_forward_all)["green_rating"],
"NA",
coef(lm_step_all)["green_rating"],
coef(lm_medium_a)["green_rating"],
coef(lm_forward_a)["green_rating"],
"NA",
coef(lm_step_a)["green_rating"],
coef(lm_medium_b)["green_rating"],
coef(lm_forward_b)["green_rating"],
"NA",
coef(lm_step_b)["green_rating"]
)
models <- c("lm_medium_all Model",
"lm_forward_all Model",
"lm_backward_all Model",
"lm_step_all Model",
"lm_medium_class.a Model",
"lm_forward_class.a Model",
"lm_backward_class.a Model",
"lm_step_class.a Model",
"lm_medium_class.b Model",
"lm_forward_class.b Model",
"lm_backward_class.b Model",
"lm_step_class.b Model"
)
models.coefficients <- data.frame(
model_type = models,
green_rating_value = green_rating_coefficient
)
models.coefficients
x = as.matrix(greenbuildings[,-5])
y = as.matrix(greenbuildings[,5])
mu_x = colMeans(x)
nir_variables = seq(1, 22, by=1)
#par(mfrow=c(2,2))
#for(i in sample.int(nrow(x), 4)) {
# plot(nir_variables, x[i,] - mu_x, main=i)
#}
sigma_x = cor(x)
sigma_x[1:10,1:10]
# Let's try dimensionality reduction via PCA
pc_greenbuildings = prcomp(x, scale=TRUE)
# pc_greenbuildings$x has the summary variables
# Regress on the first K
K = 3
rent = pc_greenbuildings$x[,1:K]
pcr1 = lm(y ~ rent)
summary(pcr1)
plot(fitted(pcr1), y)
# Visualize the first few principal components:
# these are the coefficients in the linear combination for each summary
plot(nir_variables, pc_greenbuildings$rotation[,1])
plot(nir_variables, pc_greenbuildings$rotation[,2])
plot(nir_variables, pc_greenbuildings$rotation[,3])
x = as.matrix(greenbuildings[,-5])
y = as.matrix(greenbuildings[,5])
mu_x = colMeans(x)
nir_variables = seq(1, 22, by=1)
sigma_x = cor(x)
sigma_x[1:10,1:10]
# Let's try dimensionality reduction via PCA
pc_greenbuildings = prcomp(x, scale=TRUE)
# pc_greenbuildings$x has the summary variables
# Regress on the first K
K = 3
rent = pc_greenbuildings$x[,1:K]
pcr1 = lm(y ~ rent)
summary(pcr1)
plot(fitted(pcr1), y)
# Visualize the first few principal components:
# these are the coefficients in the linear combination for each summary
plot(nir_variables, pc_greenbuildings$rotation[,1])
plot(nir_variables, pc_greenbuildings$rotation[,2])
plot(nir_variables, pc_greenbuildings$rotation[,3])
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(reshape2)
library(expss)
library(mosaic)
library(foreach)
library(gamlr)
# load the main data
greenbuildings <- read.csv('greenbuildings.csv')
greenbuildings <- na.omit(greenbuildings)# there were na's in the set, so na.omit desn't use them but keeps them in the df.
greenbuildings_a <- subset(greenbuildings,class_a=="1")
greenbuildings_b <- subset(greenbuildings,class_b=="1")
#use the saratoga script to model rent pricing####
# baseline medium model
lm_medium <- function(x){
lm(Rent ~ cluster + size + stories + age + renovated + class_a + class_b + green_rating + amenities + Gas_Costs + Electricity_Costs + cluster_rent, data=x)
}
# forward selection
lm_forward <- function(x){
lm0 = lm(Rent ~ 1, data=x)
lm_forward = step(lm0, direction='forward',scope=~(cluster + size + stories + age + renovated + class_a + class_b + green_rating + amenities + Gas_Costs + Electricity_Costs + cluster_rent)^2)
}
# backward selection?
lm_backward <- function(x){
lm(Rent ~ (cluster + size + stories + age + renovated + class_a + class_b + green_rating + amenities + Gas_Costs + Electricity_Costs + cluster_rent)^2, data=x)
}
# stepwise selection
# note that we start with a reasonable guess
lm_step <- function(x){
step(lm(Rent ~ cluster + size + stories + age + renovated + class_a + class_b + green_rating + amenities + Gas_Costs + Electricity_Costs + cluster_rent, data=x),
scope=~(. + cluster + size + stories + age + renovated + class_a + class_b + green_rating + amenities + Gas_Costs + Electricity_Costs + cluster_rent)^2)
}
n.coefficients <- function(x){
as.numeric(sapply(x, length)[1]) + 1
}
lm_medium_all <- lm_medium(greenbuildings)
lm_forward_all <- lm_forward(greenbuildings)
lm_backward_all <- drop1(lm_backward(greenbuildings))
lm_step_all <- lm_step(greenbuildings)
variables <- c(n.coefficients(lm_medium_all),
n.coefficients(lm_forward_all),
n.coefficients(lm_backward_all),
n.coefficients(lm_step_all)
)
models <- c("lm_medium_all Model",
"lm_forward_all Model",
"lm_backward_all Model",
"lm_step_all Model"
)
models.variables <- data.frame(
model_type = models,
Number_of_variables = variables
)
models.variables
green_rating_coefficient <- c(
coef(lm_medium_all)["green_rating"],
coef(lm_forward_all)["green_rating"],
"NA",
coef(lm_step_all)["green_rating"]
)
models <- c("lm_medium_all Model",
"lm_forward_all Model",
"lm_backward_all Model",
"lm_step_all Model"
)
models.coefficients <- data.frame(
model_type = models,
green_rating_value = green_rating_coefficient
)
models.coefficients
lm_medium_a <- lm_medium(greenbuildings_a)
lm_forward_a <- lm_forward(greenbuildings_a)
lm_backward_a <- drop1(lm_backward(greenbuildings_a))
lm_step_a <- lm_step(greenbuildings_a)
lm_medium_b <- lm_medium(greenbuildings_b)
lm_forward_b <- lm_forward(greenbuildings_b)
lm_backward_b <- drop1(lm_backward(greenbuildings_b))
lm_step_b <- lm_step(greenbuildings_b)
green_rating_coefficient <- c(
coef(lm_medium_all)["green_rating"],
coef(lm_forward_all)["green_rating"],
"NA",
coef(lm_step_all)["green_rating"],
coef(lm_medium_a)["green_rating"],
coef(lm_forward_a)["green_rating"],
"NA",
coef(lm_step_a)["green_rating"],
coef(lm_medium_b)["green_rating"],
coef(lm_forward_b)["green_rating"],
"NA",
coef(lm_step_b)["green_rating"]
)
models <- c("lm_medium_all Model",
"lm_forward_all Model",
"lm_backward_all Model",
"lm_step_all Model",
"lm_medium_class.a Model",
"lm_forward_class.a Model",
"lm_backward_class.a Model",
"lm_step_class.a Model",
"lm_medium_class.b Model",
"lm_forward_class.b Model",
"lm_backward_class.b Model",
"lm_step_class.b Model"
)
models.coefficients <- data.frame(
model_type = models,
green_rating_value = green_rating_coefficient
)
models.coefficients
lm_medium_a <- lm_medium(greenbuildings_a)
lm_forward_a <- lm_forward(greenbuildings_a)
green_rating_coefficient <- c(
coef(lm_medium_all)["green_rating"],
coef(lm_forward_all)["green_rating"],
"NA",
coef(lm_step_all)["green_rating"],
coef(lm_medium_a)["green_rating"],
coef(lm_forward_a)["green_rating"],
"NA",
coef(lm_step_a)["green_rating"],
coef(lm_medium_b)["green_rating"],
coef(lm_forward_b)["green_rating"],
"NA",
coef(lm_step_b)["green_rating"]
)
models <- c("lm_medium_all Model",
"lm_forward_all Model",
"lm_backward_all Model",
"lm_step_all Model",
"lm_medium_class.a Model",
"lm_forward_class.a Model",
"lm_backward_class.a Model",
"lm_step_class.a Model",
"lm_medium_class.b Model",
"lm_forward_class.b Model",
"lm_backward_class.b Model",
"lm_step_class.b Model"
)
models.coefficients <- data.frame(
model_type = models,
green_rating_value = green_rating_coefficient
)
models.coefficients
