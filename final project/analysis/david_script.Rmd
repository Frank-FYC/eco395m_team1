---
title: "Davids_R_Script"
author: "David Fraire"
date: "5/10/2019"
output: html_document
---
Code for loading Library Packages
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(foreign)
library(matrixStats)
library(readr)
library(FNN)
library(tidyverse)
library(datasets)
library(dbplyr)
library(dplyr)
library(ggformula)
library(ggplot2)
library(ggstance)
library(graphics)
library(grDevices)
library(haven)
library(lattice)
library(markdown)
library(Matrix)
library(methods)
library(mosaic)
library(mosaicData)
library(pander)
library(RColorBrewer)
library(stargazer)
library(stringr)
library(tidyr)
library(tidyverse)

```
Research Question: What is the impact of Headstart in the short/long term effect on the participants, specifically the non-white children. 

Personal hypothesis (guided by provided research papers): Yes, the short term effect on non-white children will be more pronounced in the short-term and long-term. There might be a more pronounced "fade-out" effect in the white chidren, but overall the "fade-out" will be seen on average across the particpants.


The following regressions show in table form will represent the effects of the Headstart program on PPVTat3, College Education, and High School graduation. To begin, we have regressions run including demographic factors such as race, gender, and whether or not the child is firstborn. 




First, we decided to use a Genearlized Linear Model to proceed with analysis of the effect of Headstart program on non-white participants. The 1st regression includes the following variables: birthweight, hsgrad, Firstborn, Hispanic, Black, Male. Birthweight
#HS on PPVT Score
``` {r}
# Import data and begin analysis
final <- read.csv("../data/finaldataset.csv", header=TRUE)
demingfinal<-read_stata("../data/deming_final_data.dta")
View(demingfinal)
View(final)
summary(final,)
colnames(final)

final.na = na.omit(final)

# Linear and Generlized models
lmPPVT <- lm(headstart~PPVTat3, data=final)
lmPPVT <- lm(headstart ~ PPVTat3, data=final, na.action = na.omit)

coef(lmPPVT)
glmPPVT = glm(headstart~PPVTat3, data=final, family=binomial)
glmPPVT2 = glm(headstart~Hispanic + Black + Male + PPVTat3, data=final, family=binomial, na.action = na.omit)
glmPPVT3 = glm(headstart~ BirthWeight+hsgrad+FirstBorn + Hispanic + Black + Male  , data=final, family=binomial)


#final$glm1resid<- predict.glm(glm1) ## Predict function requires no NA's
#final$glmPPVT2resid<- predict.glm(glmPPVT) ## Calculated residuals for rows with no NA
#final$glm3resid<- predict.glm(glm3) 

lm(headstart ~ glm2resid, data=final, family=binomial)

stargazer::stargazer(glm3, glm2, glm1, lm1,lm2,type="text", flip=TRUE)


## Extra models
lm1_0<- lm(PPVTat3~headstart + Male + Black + Hispanic, data=final)
lm1_1<- lm(PPVTat3~headstart + Male + Black + Hispanic + mentaldisability, data=final)

stargazer(lm1_0,lm1_1, type="text")



sibling = final %>%
  group_by(MotherID, ChildID, headstart,Black, Hispanic) %>%
  summarise()

count(final$headstart == 1)

```


#HS on College Enrollment
``` {r}

lmCE<- lm(somecollege~headstart, data=final)
lmCE1<-lm(somecollege~headstart + Male + Black + Hispanic, data=final)
glmCE <- glm(somecollege~headstart, data=final, family=binomial)
glmCE1 <-glm(somecollege~headstart + Male + Black + Hispanic, data=final, family=binomial)

stargazer::stargazer(glmCE1, glmCE, lmCE,lmCE1, type="text", title="Regressions of HS on College Enrollment")



```


#HS on HSgrad
``` {r}
lmhs<- lm(hsgrad~headstart, data=final)
lmhs1<-lm(hsgrad~headstart + Male + Black + Hispanic, data=final)
glmhs <- glm(hsgrad~headstart, data=final, family=binomial)
glmhs1 <-glm(hsgrad~headstart + Male + Black + Hispanic, data=final, family=binomial)

stargazer::stargazer(glmhs1, glmhs, lmhs,lmhs1, type="text", title="Regressions of HS on High School Graduation")

```


