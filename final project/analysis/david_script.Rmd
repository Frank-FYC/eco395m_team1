---
title: "Davids_R_Script"
author: "David Fraire"
date: "5/16/2019"
output: pdf_document
---
#Code for loading Library Packages
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(foreign)
library(matrixStats)
library(readr)
library(FNN)
library(tidyverse)
library(datasets)
library(dbplyr)
library(dplyr)
library(ggformula)
library(ggplot2)
library(ggstance)
library(graphics)
library(grDevices)
library(haven)
library(lattice)
library(markdown)
library(Matrix)
library(methods)
library(mosaic)
library(mosaicData)
library(pander)
library(RColorBrewer)
library(stargazer)
library(stringr)
library(tidyr)
library(tidyverse)

```


The following regressions show in table form will represent the effects of the Headstart program on **PPVTat3**, **somecollege**, **hsgrad**. 

We decided to use a Genearlized Linear Models with logit link funcitons and a Linear Models to proceed with analysis of the effect of Headstart program on the three aforementioned dependent variables. 

#HS on PPVT Score at Age 3
``` {r ,echo=FALSE}
final <- read.csv("../data/finaldataset.csv", header=TRUE)

lmPPVT0 = lm(PPVTat3~headstart, data=final)
lmPPVT1 = lm(PPVTat3~headstart + BirthWeight + Male , data=final)
lmPPVT2 = lm(PPVTat3~headstart + Hispanic + Black + Male, data=final)
lmPPVT3 = lm(PPVTat3~headstart + Hispanic + Black + Male + BirthWeight + hsgrad + FirstBorn, data=final)

stargazer::stargazer(lmPPVT0, lmPPVT1, lmPPVT2, lmPPVT3 ,type="latex", title="Headstart effect on PPVT Scores at Age 3")


```

For the first table, we regressed the data for PPVTat3 on headstart using a linear fit to begin. The effect of the headstart program in this model shows a negative effect ranging from -6.741 to -2.179 PPVT scores across all regressions. This means that participation in Headstart has a negative effect on the test scores with the data provided in our dataset. Given that the children who participate in Headstart are likely to come from disadvatanged socioeconomic backgrounds, this can be explained in the following models as those who are in Headstart will likely have lower scores to start. 

#HS on College Enrollment
``` {r, echo=FALSE}

glmCE0<- glm(somecollege~headstart, data=final, family=binomial)
glmCE1<- glm(somecollege~headstart + Male, data=final, family=binomial)
glmCE2<- glm(somecollege~headstart + Male + Black + Hispanic, data=final, family=binomial)
glmCE3<- glm(somecollege~headstart + Male + Black + Hispanic + BirthWeight + LogInc_0to3, data=final, family=binomial)

stargazer::stargazer(glmCE0, glmCE1, glmCE2, glmCE3, type="text", title="Regressions of HS on College Enrollment")
```

For the effect of Headstart on college enrollment which is measured by the variable **somecollege**, we used a logit model to see the partial effects on the outcome of having gone to college. Simply running a regression of **headstart** on **somecollege** shows that **headstart** has a significant effect on the outcome of having enrolled at a college. 

#HS on High School grad
``` {r, echo=FALSE}
glmhs0<- glm(hsgrad~headstart, data=final, family=binomial)
glmhs1<- glm(hsgrad~headstart + Male , data=final, family=binomial)
glmhs2<- glm(hsgrad~headstart + Male + Black + Hispanic , data=final, family=binomial)
glmhs3<- glm(hsgrad~headstart + Male + Black + Hispanic +LogInc_0to3 + MothED, data=final, family=binomial)

stargazer::stargazer(glmhs0, glmhs1, glmhs2, glmhs3, type="text", title="Regressions of HS on High School Graduation")

```


