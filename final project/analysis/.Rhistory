# backward selection?
lm_backward <- function(x){
lm(Repeat ~ (headstart+Hispanic+Black+Male+LogInc_0to3+MothED+Father_HH_0to3+mentaldisability+learndisability+FirstBorn+Age_Moth_Birth)^2, data=x)
}
# stepwise selection
# note that we start with a reasonable guess
lm_step <- function(x){
step(lm(Repeat ~ headstart+Hispanic+Black+Male+LogInc_0to3+MothED+Father_HH_0to3+mentaldisability+learndisability+FirstBorn+Age_Moth_Birth, data=x),
scope=~(. + headstart+Hispanic+Black+Male+LogInc_0to3+MothED+Father_HH_0to3+mentaldisability+learndisability+FirstBorn+Age_Moth_Birth)^2)
}
n.coefficients <- function(x){
as.numeric(sapply(x, length)[1]) + 1
}
# Best model
lm_medium_all <- lm_medium(df)
lm_forward_all <- lm_forward(df)
lm_backward_all <- drop1(lm_backward(df))
view(df)
da <- dt[complete.cases(dt$LogInc_0to3),]
db <- da[complete.cases(da$Father_HH_0to3),]
dc <- db[complete.cases(db$MothED),]
dd <- dc[complete.cases(dc$FirstBorn),]
de <- dd[complete.cases(dd$Age_Moth_Birth),]
df <- de[complete.cases(de$Repeat),]
view(df)
#summarize data
summary(df)
# baseline medium model
lm_medium <- function(x){
lm(Repeat ~  headstart+Hispanic+Black+Male+LogInc_0to3+MothED+Father_HH_0to3+mentaldisability+learndisability+FirstBorn+Age_Moth_Birth, data=x)
}
# forward selection
lm_forward <- function(x){
lm0 = lm(Repeat ~ 1, data=x)
lm_forward = step(lm0, direction='forward',scope=~(headstart+Hispanic+Black+Male+LogInc_0to3+MothED+Father_HH_0to3+mentaldisability+learndisability+FirstBorn+logBW+Age_Moth_Birth)^2)
}
# backward selection?
lm_backward <- function(x){
lm(Repeat ~ (headstart+Hispanic+Black+Male+LogInc_0to3+MothED+Father_HH_0to3+mentaldisability+learndisability+FirstBorn+Age_Moth_Birth)^2, data=x)
}
# stepwise selection
# note that we start with a reasonable guess
lm_step <- function(x){
step(lm(Repeat ~ headstart+Hispanic+Black+Male+LogInc_0to3+MothED+Father_HH_0to3+mentaldisability+learndisability+FirstBorn+Age_Moth_Birth, data=x),
scope=~(. + headstart+Hispanic+Black+Male+LogInc_0to3+MothED+Father_HH_0to3+mentaldisability+learndisability+FirstBorn+Age_Moth_Birth)^2)
}
n.coefficients <- function(x){
as.numeric(sapply(x, length)[1]) + 1
}
# Best model
lm_medium_all <- lm_medium(df)
lm_forward_all <- lm_forward(df)
lm_backward_all <- drop1(lm_backward(df))
lm_step_all <- lm_step(df)
variables <- c(n.coefficients(lm_medium_all),
n.coefficients(lm_forward_all),
n.coefficients(lm_backward_all),
n.coefficients(lm_step_all)
)
models <- c("lm_medium_all Model",
"lm_forward_all Model",
"lm_backward_all Model",
"lm_step_all Model"
)
models.variables <- data.frame(
model_type = models,
Number_of_variables = variables
)
models.variables
## Determining Head start Effects on Repeat grade
headstart_coefficient <- c(
coef(lm_medium_all)["headstart"],
coef(lm_forward_all)["headstart"],
coef(lm_backward_all) ["headstart"]
coef(lm_step_all)["headstart"]
)
## Determining Head start Effects on Repeat grade
headstart_coefficient <- c(
coef(lm_medium_all)["headstart"],
coef(lm_forward_all)["headstart"],
coef(lm_backward_all)["headstart"],
coef(lm_step_all)["headstart"]
)
models <- c("lm_medium_all Model",
"lm_forward_all Model",
"lm_backward_all Model",
"lm_step_all Model"
)
models.coefficients <- data.frame(
model_type = models,
headstart_value = headstart_coefficient
)
# Best model
lm_medium_all <- lm_medium(df)
library(tidyverse)
library(foreign)
library(psycho)
library(reshape2)
library(expss)
library(mosaic)
library(foreach)
library(gamlr)
#read data
dt = read.csv('../data/finaldataset.csv')
view(dt)
da <- dt[complete.cases(dt$LogInc_0to3),]
db <- da[complete.cases(da$Father_HH_0to3),]
dc <- db[complete.cases(db$MothED),]
dd <- dc[complete.cases(dc$FirstBorn),]
de <- dd[complete.cases(dd$Age_Moth_Birth),]
df <- de[complete.cases(de$Repeat),]
view(df)
#summarize data
summary(df)
# baseline medium model
lm_medium <- function(x){
lm(Repeat ~  headstart+Hispanic+Black+Male+LogInc_0to3+MothED+Father_HH_0to3+mentaldisability+learndisability+FirstBorn+Age_Moth_Birth, data=x)
}
# forward selection
lm_forward <- function(x){
lm0 = lm(Repeat ~ 1, data=x)
lm_forward = step(lm0, direction='forward',scope=~(headstart+Hispanic+Black+Male+LogInc_0to3+MothED+Father_HH_0to3+mentaldisability+learndisability+FirstBorn+logBW+Age_Moth_Birth)^2)
}
# backward selection?
lm_backward <- function(x){
lm(Repeat ~ (headstart+Hispanic+Black+Male+LogInc_0to3+MothED+Father_HH_0to3+mentaldisability+learndisability+FirstBorn+Age_Moth_Birth)^2, data=x)
}
# stepwise selection
# note that we start with a reasonable guess
lm_step <- function(x){
step(lm(Repeat ~ headstart+Hispanic+Black+Male+LogInc_0to3+MothED+Father_HH_0to3+mentaldisability+learndisability+FirstBorn+Age_Moth_Birth, data=x),
scope=~(. + headstart+Hispanic+Black+Male+LogInc_0to3+MothED+Father_HH_0to3+mentaldisability+learndisability+FirstBorn+Age_Moth_Birth)^2)
}
n.coefficients <- function(x){
as.numeric(sapply(x, length)[1]) + 1
}
# Best model
lm_medium_all <- lm_medium(df)
lm_forward_all <- lm_forward(df)
lm_backward_all <- drop1(lm_backward(df))
lm_step_all <- lm_step(df)
variables <- c(n.coefficients(lm_medium_all),
n.coefficients(lm_forward_all),
n.coefficients(lm_backward_all),
n.coefficients(lm_step_all)
)
models <- c("lm_medium_all Model",
"lm_forward_all Model",
"lm_backward_all Model",
"lm_step_all Model"
)
models.variables <- data.frame(
model_type = models,
Number_of_variables = variables
)
models.variables
## Determining Head start Effects on Repeat grade
headstart_coefficient <- c(
coef(lm_medium_all)["headstart"],
coef(lm_forward_all)["headstart"],
coef(lm_backward_all)["headstart"],
coef(lm_step_all)["headstart"]
)
models <- c("lm_medium_all Model",
"lm_forward_all Model",
"lm_backward_all Model",
"lm_step_all Model"
)
models.coefficients <- data.frame(
model_type = models,
headstart_value = headstart_coefficient
)
headstart_coefficient
coef(lm_medium_all)["headstart"]
coef(lm_forward_all)["headstart"]
coef(lm_backward_all)["headstart"]
## Determining Head start Effects on Repeat grade
headstart_coefficient <- c(
coef(lm_medium_all)["headstart"],
coef(lm_forward_all)["headstart"],
"NA",
coef(lm_step_all)["headstart"]
)
models <- c("lm_medium_all Model",
"lm_forward_all Model",
"lm_backward_all Model",
"lm_step_all Model"
)
models.coefficients <- data.frame(
model_type = models,
headstart_value = headstart_coefficient
)
models.coefficients
#Gamma Lasso regression
scx = sparse.model.matrix(Repeat ~ ., data=df)[,-1]
#Gamma Lasso regression
scx = sparse.model.matrix(Repeat ~ headstart+Hispanic+Black+Male+LogInc_0to3+MothED+Father_HH_0to3+mentaldisability+learndisability+FirstBorn+Age_Moth_Birth, data=df)[,-1]
scy = df$Repeat
sclasso = gamlr(scx, scy)
plot(sclasso)
lm_medium = lm(Repeat ~  headstart+Hispanic+Black+Male+LogInc_0to3+MothED+Father_HH_0to3+mentaldisability+learndisability+FirstBorn+Age_Moth_Birth, data=df)
lm_step = step(lm_medium,
scope=~(. + headstart+Hispanic+Black+Male+LogInc_0to3+MothED+Father_HH_0to3+mentaldisability+learndisability+FirstBorn+Age_Moth_Birth)^2)
lmstepbeta = coef(lm_step)["haedstart"]
lmstepbeta
scbeta = coef(sclasso)
scbeta
lmstepbeta = coef(lm_step)["headstart"]
lmstepbeta
scbeta = coef(sclasso)
scbeta
dg <- df[complete.cases(df$PoorHealth),]
dh <- dg[complete.cases(dg$logBW),]
dg <- df[complete.cases(df$PoorHealth),]
dh <- dg[complete.cases(dg$logBW),]
# baseline medium model
lm_medium <- function(x){
lm(PoorHealth ~  headstart+Hispanic+Black+Male+LogInc_0to3+FirstBorn+Age_Moth_Birth+logBW, data=x)
}
# forward selection
lm_forward <- function(x){
lm0 = lm(PoorHealth ~ 1, data=x)
lm_forward = step(lm0, direction='forward',scope=~(headstart+Hispanic+Black+Male+LogInc_0to3+FirstBorn+Age_Moth_Birth+logBW)^2)
}
# backward selection?
lm_backward <- function(x){
lm(PoorHealth ~ (headstart+Hispanic+Black+Male+LogInc_0to3+FirstBorn+Age_Moth_Birth+logBW)^2, data=x)
}
# stepwise selection
# note that we start with a reasonable guess
lm_step <- function(x){
step(lm(PoorHealth ~ headstart+Hispanic+Black+Male+LogInc_0to3+FirstBorn+Age_Moth_Birth+logBW, data=x),
scope=~(. + headstart+Hispanic+Black+Male+LogInc_0to3+FirstBorn+Age_Moth_Birth+logBW)^2)
}
n.coefficients <- function(x){
as.numeric(sapply(x, length)[1]) + 1
}
# Best model
lm_medium_all <- lm_medium(dh)
lm_forward_all <- lm_forward(dh)
lm_backward_all <- drop1(lm_backward(dh))
lm_step_all <- lm_step(dh)
variables <- c(n.coefficients(lm_medium_all),
n.coefficients(lm_forward_all),
n.coefficients(lm_backward_all),
n.coefficients(lm_step_all)
)
models <- c("lm_medium_all Model",
"lm_forward_all Model",
"lm_backward_all Model",
"lm_step_all Model"
)
models.variables <- data.frame(
model_type = models,
Number_of_variables = variables
)
models.variables
## Determining Head start Effects on Repeat grade
headstart_coefficient <- c(
coef(lm_medium_all)["headstart"],
coef(lm_forward_all)["headstart"],
"NA",
coef(lm_step_all)["headstart"]
)
models <- c("lm_medium_all Model",
"lm_forward_all Model",
"lm_backward_all Model",
"lm_step_all Model"
)
models.coefficients <- data.frame(
model_type = models,
headstart_value = headstart_coefficient
)
models.coefficients
headstart_coefficient <- c(
coef(lm_medium_all)["headstart"],
coef(lm_forward_all)["headstart"],
coef(lm_backward_all)["headstart"],
coef(lm_step_all)["headstart"]
)
models <- c("lm_medium_all Model",
"lm_forward_all Model",
"lm_backward_all Model",
"lm_step_all Model"
)
models.coefficients <- data.frame(
model_type = models,
headstart_value = headstart_coefficient
)
models.coefficients
## Determining Head start Effects on Repeat grade
headstart_coefficient <- c(
coef(lm_medium_all)["headstart"],
coef(lm_forward_all)["headstart"],
coef(lm_backward_all)["headstart"],
coef(lm_step_all)["headstart"]
)
models <- c("lm_medium_all Model",
"lm_forward_all Model",
"lm_backward_all Model",
"lm_step_all Model"
)
models.coefficients <- data.frame(
model_type = models,
headstart_value = headstart_coefficient
)
models.coefficients
#call libraries
library(tidyverse)
library(foreign)
library(psycho)
library(reshape2)
library(expss)
library(mosaic)
library(foreach)
library(gamlr)
#read data
dt = read.csv('../data/finaldataset.csv')
view(dt)
da <- dt[complete.cases(dt$LogInc_0to3),]
db <- da[complete.cases(da$Father_HH_0to3),]
dc <- db[complete.cases(db$MothED),]
dd <- dc[complete.cases(dc$FirstBorn),]
de <- dd[complete.cases(dd$Age_Moth_Birth),]
df <- de[complete.cases(de$Repeat),]
view(df)
#summarize data
summary(df)
##########################################################################33
############Effect of HS on Repeat grade
# baseline medium model
lm_medium <- function(x){
lm(Repeat ~  headstart+Hispanic+Black+Male+LogInc_0to3+MothED+Father_HH_0to3+mentaldisability+learndisability+FirstBorn+Age_Moth_Birth, data=x)
}
# forward selection
lm_forward <- function(x){
lm0 = lm(Repeat ~ 1, data=x)
lm_forward = step(lm0, direction='forward',scope=~(headstart+Hispanic+Black+Male+LogInc_0to3+MothED+Father_HH_0to3+mentaldisability+learndisability+FirstBorn+logBW+Age_Moth_Birth)^2)
}
# backward selection?
lm_backward <- function(x){
lm(Repeat ~ (headstart+Hispanic+Black+Male+LogInc_0to3+MothED+Father_HH_0to3+mentaldisability+learndisability+FirstBorn+Age_Moth_Birth)^2, data=x)
}
# stepwise selection
# note that we start with a reasonable guess
lm_step <- function(x){
step(lm(Repeat ~ headstart+Hispanic+Black+Male+LogInc_0to3+MothED+Father_HH_0to3+mentaldisability+learndisability+FirstBorn+Age_Moth_Birth, data=x),
scope=~(. + headstart+Hispanic+Black+Male+LogInc_0to3+MothED+Father_HH_0to3+mentaldisability+learndisability+FirstBorn+Age_Moth_Birth)^2)
}
n.coefficients <- function(x){
as.numeric(sapply(x, length)[1]) + 1
}
# Best model
lm_medium_all <- lm_medium(df)
lm_forward_all <- lm_forward(df)
lm_backward_all <- drop1(lm_backward(df))
lm_step_all <- lm_step(df)
variables <- c(n.coefficients(lm_medium_all),
n.coefficients(lm_forward_all),
n.coefficients(lm_backward_all),
n.coefficients(lm_step_all)
)
models <- c("lm_medium_all Model",
"lm_forward_all Model",
"lm_backward_all Model",
"lm_step_all Model"
)
models.variables <- data.frame(
model_type = models,
Number_of_variables = variables
)
models.variables
## Determining Head start Effects on Repeat grade
headstart_coefficient <- c(
coef(lm_medium_all)["headstart"],
coef(lm_forward_all)["headstart"],
coef(lm_backward_all)["headstart"],
coef(lm_step_all)["headstart"]
)
models <- c("lm_medium_all Model",
"lm_forward_all Model",
"lm_backward_all Model",
"lm_step_all Model"
)
models.coefficients <- data.frame(
model_type = models,
headstart_value = headstart_coefficient
)
models.coefficients
## Determining Head start Effects on Repeat grade
headstart_coefficient <- c(
coef(lm_medium_all)["headstart"],
coef(lm_forward_all)["headstart"],
"NA",
coef(lm_step_all)["headstart"]
)
models <- c("lm_medium_all Model",
"lm_forward_all Model",
"lm_backward_all Model",
"lm_step_all Model"
)
models.coefficients <- data.frame(
model_type = models,
headstart_value = headstart_coefficient
)
models.coefficients
#Gamma Lasso regression
scx = sparse.model.matrix(Repeat ~ headstart+Hispanic+Black+Male+LogInc_0to3+MothED+Father_HH_0to3+mentaldisability+learndisability+FirstBorn+Age_Moth_Birth, data=df)[,-1]
scy = df$Repeat
sclasso = gamlr(scx, scy)
plot(sclasso)
lm_medium = lm(Repeat ~  headstart+Hispanic+Black+Male+LogInc_0to3+MothED+Father_HH_0to3+mentaldisability+learndisability+FirstBorn+Age_Moth_Birth, data=df)
lm_step = step(lm_medium,
scope=~(. + headstart+Hispanic+Black+Male+LogInc_0to3+MothED+Father_HH_0to3+mentaldisability+learndisability+FirstBorn+Age_Moth_Birth)^2)
lmstepbeta = coef(lm_step)["headstart"]
lmstepbeta
scbeta = coef(sclasso)
scbeta
dg <- df[complete.cases(df$PoorHealth),]
dh <- dg[complete.cases(dg$logBW),]
# baseline medium model
lm_medium <- function(x){
lm(PoorHealth ~  headstart+Hispanic+Black+Male+LogInc_0to3+FirstBorn+Age_Moth_Birth+logBW, data=x)
}
# forward selection
lm_forward <- function(x){
lm0 = lm(PoorHealth ~ 1, data=x)
lm_forward = step(lm0, direction='forward',scope=~(headstart+Hispanic+Black+Male+LogInc_0to3+FirstBorn+Age_Moth_Birth+logBW)^2)
}
# backward selection?
lm_backward <- function(x){
lm(PoorHealth ~ (headstart+Hispanic+Black+Male+LogInc_0to3+FirstBorn+Age_Moth_Birth+logBW)^2, data=x)
}
# stepwise selection
# note that we start with a reasonable guess
lm_step <- function(x){
step(lm(PoorHealth ~ headstart+Hispanic+Black+Male+LogInc_0to3+FirstBorn+Age_Moth_Birth+logBW, data=x),
scope=~(. + headstart+Hispanic+Black+Male+LogInc_0to3+FirstBorn+Age_Moth_Birth+logBW)^2)
}
n.coefficients <- function(x){
as.numeric(sapply(x, length)[1]) + 1
}
# Best model
lm_medium_all <- lm_medium(dh)
lm_forward_all <- lm_forward(dh)
lm_backward_all <- drop1(lm_backward(dh))
lm_step_all <- lm_step(dh)
variables <- c(n.coefficients(lm_medium_all),
n.coefficients(lm_forward_all),
n.coefficients(lm_backward_all),
n.coefficients(lm_step_all)
)
models <- c("lm_medium_all Model",
"lm_forward_all Model",
"lm_backward_all Model",
"lm_step_all Model"
)
models.variables <- data.frame(
model_type = models,
Number_of_variables = variables
)
models.variables
## Determining Head start Effects on Repeat grade
headstart_coefficient <- c(
coef(lm_medium_all)["headstart"],
coef(lm_forward_all)["headstart"],
coef(lm_backward_all)["headstart"],
coef(lm_step_all)["headstart"]
)
models <- c("lm_medium_all Model",
"lm_forward_all Model",
"lm_backward_all Model",
"lm_step_all Model"
)
models.coefficients <- data.frame(
model_type = models,
headstart_value = headstart_coefficient
)
models.coefficients
## Determining Head start Effects on Repeat grade
headstart_coefficient <- c(
coef(lm_medium_all)["headstart"],
coef(lm_forward_all)["headstart"],
"NA",
coef(lm_step_all)["headstart"]
)
models <- c("lm_medium_all Model",
"lm_forward_all Model",
"lm_backward_all Model",
"lm_step_all Model"
)
models.coefficients <- data.frame(
model_type = models,
headstart_value = headstart_coefficient
)
models.coefficients
#Gamma Lasso regression
scx = sparse.model.matrix(PoorHealth ~ headstart+Hispanic+Black+Male+LogInc_0to3+FirstBorn+Age_Moth_Birth+logBW, data=df)[,-1]
scy = df$Repeat
sclasso = gamlr(scx, scy)
#Gamma Lasso regression
scx = sparse.model.matrix(PoorHealth ~ headstart+Hispanic+Black+Male+LogInc_0to3+FirstBorn+Age_Moth_Birth+logBW, data=df)[,-1]
scy = df$PoorHealth
sclasso = gamlr(scx, scy)
plot(sclasso)
lm_medium = lm(PoorHealth ~  headstart+Hispanic+Black+Male+LogInc_0to3+FirstBorn+Age_Moth_Birth+logBW, data=df)
lm_step = step(lm_medium,
scope=~(. + headstart+Hispanic+Black+Male+LogInc_0to3+FirstBorn+Age_Moth_Birth+logBW)^2)
lmstepbeta = coef(lm_step)["headstart"]
lmstepbeta
scbeta = coef(sclasso)
scbeta
